---
title: "Exame 1"
subtitle: "Introdução à Ciência dos Dados 2023"
lang: "pt"
date: today
author:
  - name: Prof. Washington Santos da Silva 
    affiliation: IFMG - Campus Formiga - Mestrado Profissional em Administração.
    affiliation-url: https://www.formiga.ifmg.edu.br/mestrado
format:
  html:
    self-contained: true
    toc: true
    toc-location: left
    number-sections: false
    smooth-scroll: true
    theme: solarized
---

<style type="text/css">
  body{
  font-size: 12pt;
  text-align: justify
      }
</style>

```{r setup, include = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(readr)
library(skimr)
library(ggplot2)
library(ggthemes)
library(janitor)
library(scales)
```


## Dados

Para ilustrar os conceitos básicos sobre a análise exploratória de dados, utilizem os dados do estudo de caso do Bookbinders Book Club contidos no 
arquivo `BBBClub.csv`. O arquivo contém 1.300 observações sobre 11 variáveis descritas a seguir:

variável        Descrição
------------    --------------------------------------------------------
`choice`        O cliente comprou o livro “A História da Arte de Florença”?
`gender`        Gênero
`amount`        Valor total gasto no BBB Club
`freq`          Frequência total de compras no BBB Club
`last`          Número de meses desde a última compra
`first`         Número de meses desde a primeira compra
`child`         Número de livros infantis comprados
`youth`         Número de livros juvenis comprados
`cook`          Número de livros de culinária comprados
`diy`           Número de livros do tipo faça você mesmo comprados
`art`           Número de livros de arte comprados



### Questão 1

Importe o arquivo `BBBClub.csv` usando a função apropriada do pacote `readr` e nomeie o objeto como `bbclub`. Utilize a função apropriada do pacote dplyr para ter uma visão geral dos dados importados.

```{r}
file <- "dados/BBBClub.csv"
bbclub <- readr::read_csv(file, col_names = TRUE)
dplyr::glimpse(bbclub)
```



### Questão 2

Execute o comando que exibe as primeiras seis linhas do objeto importado.

```{r}
head(bbclub)
```



### Questão 3  

Utilize a função `skimr` do pacote `skim` para obter um relatório detalhado dos dados importados. Analisando o relatório, os dados importandos 
são compativeis com o número de observações e variáveis informandos anteriormente? Quantas variáveis são do tipo `numeric` e quantas são do tipo `character`? Há dados faltantes?

```{r}
skimr::skim(bbclub)
```



### Questão 4 

Usando a função `transmute()` do pacote `dplyr`, altere as variáveis do 
tipo `character` para a classe `factor` (usando `factor()`) e as variáveis do tipo numérico `double` para o tipo numérico `integer` (usando `as.integer()`).

Nomeie os dados trasnformados `bbclub_analise`. Após finalizar 
a transformação, verifique se a transformação está correta usando `dplyr::glimpse()`.

```{r}
bbclub_analise <- bbclub |> 
   dplyr::transmute(choice = factor(choice),
                    gender = factor(gender),
                    amount = as.integer(amount),
                    freq = as.integer(freq),
                    last = as.integer(last),
                    first = as.integer(first),
                    child = as.integer(child),
                    youth = as.integer(youth),
                    cook = as.integer(cook),
                    diy = as.integer(diy),
                    art = as.integer(art))

dplyr::glimpse(bbclub_analise)
```



### Questão 5 

Obtenha as estimativas do valor total mínimo, o primeiro quartil do 
valor total gasto, o valor total mediano, o valor total médio, o terceiro quartil do valor total e o valor total máximo gasto no Bookbinders Book Club usando a função `summary()` aplicada sobre a variável `amount` 

(**Dica**, podemos extrair uma variável de uma data.frame usando `nome_dataframe$nome_variavel`).

Qual a interpretação das estimativas do primeiro quartil e do terceiro quartil?

```{r}
summary(bbclub_analise$amount)
```



### Questão 6

Usando o pacote `ggplot2`, faça um histograma, com densidade empírica 
sobreposta, e um boxplot da disbribuição da variável `amount` (valor total 
gasto no clube). 

Observando os gráficos exploratórios, qual (ou quais) a principal 
característica da distribuição do valor total gasto no clube?

```{r, warning=FALSE, message=FALSE}
ggplot(bbclub_analise, aes(x = amount)) + 
  geom_histogram(aes(y = ..density..)) +
  geom_density(col = "steelblue", size = 1.5) + 
  theme_minimal()
```


```{r}
ggplot(bbclub_analise, aes(x = amount)) +
  geom_boxplot() +
  coord_flip() + 
  labs(x = "Valor Total Gasto",
       y = NULL) +
  theme_minimal()
```



### Questão 7

Obtenha uma tabela contendo frequências (absolutas e 
percentuais) para a variável `last` (número de meses desde a última compra) usando a função `tabyl` do pacote `janitor`. 

```{r}
tab1 <- bbclub_analise |> 
        tabyl(last) |> 
        adorn_pct_formatting(rounding = "half up", digits = 0) |>
        knitr::kable()
tab1
```



### Questão 8

Facá um gráfico de barras da variável `last` usando o pacote `ggplot2`. 
Use `x = factor(last)` dentro de `aes`. 

Observando a tabela de frequências ou o gráfico de barras, há quantos meses a maioria dos clientes comprou algum livro?

```{r}
b1 <- ggplot(bbclub_analise, aes(x = factor(last))) + 
      geom_bar() + 
      theme_minimal()
b1
```



### Questão 9

Iniciando com `ggplot(bbclub_analise, aes(gender, amount))`, complete o 
código e faça um boxplot comparativo entre gênero e valor total gasto 
no clube. Observando o gráfico, há alguma diferença aparente na distribuição 
dos gastos entre homens e mulheres?

```{r}
ggplot(bbclub_analise, aes(x = gender, y = amount)) + 
  geom_boxplot() + 
  theme_minimal()
```



### Questão 10

Para os dados do Bookbinders Book Club, um analista de dados formula a 
hipóteses de que tende a haver uma correlação positiva entre o tempo (número de meses) desde a última compra e o valor total gasto, pois os clientes que 
podem esperar mais tempo desde sua última compra, tendem a comprar mais para cumprir os requisitos mínimos de compra do clube do livro. 

Faça um gráfico de dispersão entre as variáveis `last` e `amount` e trace uma reta de regressão. O gráfico de dispersão fornece evidências contra, ou a favor, da hipótese de que tendemos a observar uma correlação positiva entre o tempo (número de meses) desde a última compra e o valor total gasto?

```{r}
ggplot(data = bbclub_analise, mapping = aes(x = last, y = amount)) +
  geom_point() +
  geom_smooth(mapping = aes(x = last, y = amount), method = "lm")
```




