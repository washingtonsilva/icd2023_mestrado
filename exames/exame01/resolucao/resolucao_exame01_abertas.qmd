---
title: "Exame 1: Resolução"
subtitle: "Introdução à Ciência dos Dados 2023"
lang: "pt"
date: today
author:
  - name: Prof. Washington Santos da Silva 
    affiliation: IFMG - Campus Formiga - Mestrado Profissional em Administração.
    affiliation-url: https://www.formiga.ifmg.edu.br/mestrado
format:
  html:
    self-contained: true
    toc: true
    toc-location: left
    number-sections: false
    smooth-scroll: true
    theme: solarized
---

<style type="text/css">
  body{
  font-size: 12pt;
  text-align: justify
      }
</style>

```{r setup, include = FALSE, warning = FALSE, message = FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)

library(readr)
library(skimr)
library(ggplot2)
library(ggthemes)
library(janitor)
library(scales)
```



### Questão 1

```{r}
file <- "dados/BBBClub.csv"
bbclub <- readr::read_csv(file, col_names = TRUE)
dplyr::glimpse(bbclub)
```



### Questão 2

```{r}
head(bbclub)
```



### Questão 3  

```{r}
skimr::skim(bbclub)
```


::: {.callout-note icon=false}
## Respotas

1. Sim, os dados importandos são compativeis com o número de observações e variáveis informandos anteriormente, o objeto `bbclub` contém 1.300 observações sobre as 11 variáveis descritas.

2. 9 variáveis são do tipo `numeric` e 2 são do tipo `character`.

3. Não há dados faltantes segundo a saída `n_missing`.
:::



### Questão 4 

```{r}
bbclub_analise <- bbclub |> 
   dplyr::transmute(choice = factor(choice),
                    gender = factor(gender),
                    amount = as.integer(amount),
                    freq = as.integer(freq),
                    last = as.integer(last),
                    first = as.integer(first),
                    child = as.integer(child),
                    youth = as.integer(youth),
                    cook = as.integer(cook),
                    diy = as.integer(diy),
                    art = as.integer(art))

dplyr::glimpse(bbclub_analise)
```



### Questão 5 

```{r}
summary(bbclub_analise$amount)
```

::: {.callout-note icon=false}
## Respotas

1. Interpretação da estimativa do primeiro quartil: 25% dos participantes 
do clube gastaram 127 dólares ou menos na compra de livros no período analisado. 

2. Interpretação da estimativa do terceiro quartil: 75% dos participantes 
do clube gastaram 273 dólares ou menos na compra de livros no período analisado. 
:::


### Questão 6


```{r, warning=FALSE, message=FALSE}
ggplot(bbclub_analise, aes(x = amount)) + 
  geom_histogram(aes(y = ..density..)) +
  geom_density(col = "steelblue", size = 1.5) + 
  theme_minimal()
```

```{r}
ggplot(bbclub_analise, aes(x = amount)) +
  geom_boxplot() +
  coord_flip() + 
  labs(x = "Valor Total Gasto",
       y = NULL) +
  theme_minimal()
```

::: {.callout-note icon=false}
## Respota

Observando o histograma com densidade empírica sobreposta da distribuição 
dos dados, destaca-se que que a distribuição é unimodal e levemente 
assimétrica à direita (assimetria positiva). Essas características são 
confirmadas pelo boxplot.
:::


### Questão 7

```{r}
tab1 <- bbclub_analise |> 
        tabyl(last) |> 
        adorn_pct_formatting(rounding = "half up", digits = 0) |>
        knitr::kable()
tab1
```



### Questão 8

```{r}
b1 <- ggplot(bbclub_analise, aes(x = factor(last))) + 
      geom_bar() + 
      theme_minimal()
b1
```

::: {.callout-note icon=false}
## Respota

Observando o gráfico de barras, podemos verificar que a maioria dos 
clientes comprou algum livro nos últimos dois meses.
:::


### Questão 9


```{r}
ggplot(bbclub_analise, aes(x = gender, y = amount)) + 
  geom_boxplot() + 
  theme_minimal()
```

::: {.callout-note icon=false}
## Respota

Observando o boxplot comparativo, não se observa diferenças relevantes 
na distribuição dos gastos entre homens e mulheres.
:::


### Questão 10

```{r}
ggplot(data = bbclub_analise, mapping = aes(x = last, y = amount)) +
  geom_point() +
  geom_smooth(mapping = aes(x = last, y = amount), method = "lm")
```

::: {.callout-note icon=false}
## Respota

O gráfico de dispersão fornece evidência a favor da hipótese de que tendemos a observar uma correlação positiva entre o tempo (número de meses) desde a última compra e o valor total gasto, pois a inclinação da reta de regressão estimada 
é positiva, ou seja, aparentemente há uma correlação positiva, de 
moderada a forte, entre o tempo (número de meses) desde a última compra e o valor total gasto.
:::




